#!/bin/sh

# The arguments of $dt are:
#   * the size n;
#   * the precision of the inputs precx;
#   * the precision of the output precy;
#   * emax (1 = uniform inputs, large = non-uniform inputs);
#   * number of tests.
#
# Notes:
#
# The goal is to compare sum_old, sum_new and sum_add. The number of tests
# should be adjusted so that at least 2 timings are large enough. It does
# not matter if only one timing is very small and inaccurate.
#
# Some tests are run in parallel. Make sure that hyper-threading is not
# enabled, otherwise first remove the "&" at the end of each line or
# replace some of them by "&& \" depending on the available cores.

dt="$(dirname "$0")/do-timings"

# Tests with size n=10
$dt 10 10 10000000 1 200 > timings-1170 && \
$dt 10 10 10000000 100000000 200 > timings-1178 &
$dt 10 10000000 10 1 200 > timings-1710 && \
$dt 10 10000000 10 100000000 200 > timings-1718 &
$dt 10 10000000 10000000 1 200 > timings-1770 && \
$dt 10 10000000 10000000 100000000 200 > timings-1778 &

# Tests with size n=1000
$dt 1000 10 100000 1 200 > timings-3150 && \
$dt 1000 10 100000 100000000 200 > timings-3158 &
$dt 1000 100000 10 1 200 > timings-3510 && \
$dt 1000 100000 10 100000000 200 > timings-3518 &
$dt 1000 100000 100000 1 200 > timings-3550 && \
$dt 1000 100000 100000 100000000 200 > timings-3558 &

# Tests with size n=100000
$dt 100000 10 10 1 100 > timings-5110 && \
$dt 100000 10 10 100000000 100 > timings-5118 &
$dt 100000 10 1000 1 100 > timings-5130 && \
$dt 100000 10 1000 100000000 100 > timings-5138 &
$dt 100000 1000 10 1 100 > timings-5310 && \
$dt 100000 1000 10 100000000 100 > timings-5318 &
$dt 100000 1000 1000 1 100 > timings-5330 && \
$dt 100000 1000 1000 100000000 100 > timings-5338 &
