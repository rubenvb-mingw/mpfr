<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>MPFR version 2.3.1</title>
<link rel="shortcut icon" href="../favicon.ico" />
<link rel="stylesheet" type="text/css" href="../styles/screen.css" media="screen,tv,projection" />
<link rel="stylesheet" type="text/css" href="../styles/print.css" media="print" />
<link rel="top" title="The MPFR Library" href="../index.html" />
<link rel="up" title="The MPFR Library" href="../index.html" />
</head>

<body>

<div class="logo"><a href="../index.html"><img src="../mpfr100.png" height="40" width="100" alt="[MPFR]" /></a></div>

<h1><acronym>MPFR</acronym> version 2.3.1 (released on 29 January 2008)</h1>

<div>[<a href="#download">download</a>]
[<a href="#doc">documentation</a>]
[<a href="#bugs">bugs</a>]
[<a href="#changes">changes</a>]
[<a href="#platforms">platforms</a>]<!--
[<a href="timings.html" title="Comparison of other software to MPFR 2.3.1">timings</a>] --></div>

<p><acronym>MPFR</acronym> 2.3.1 requires <acronym>GMP</acronym> 4.1.0
or higher.</p>

<h2 id="download">Download</h2>

<p>The <acronym>MPFR</acronym> 2.3.1 source can be downloaded in the
following archive formats:</p>
<ul>
<li><a href="mpfr-2.3.1.tar.bz2">mpfr-2.3.1.tar.bz2</a>
(tar/bzip2, 869&nbsp;<abbr>KB</abbr>,
<a href="mpfr-2.3.1.tar.bz2.asc" title="PGP signature for mpfr-2.3.1.tar.bz2">signature</a>),</li>
<li><a href="mpfr-2.3.1.tar.gz">mpfr-2.3.1.tar.gz</a>
(tar/gzip, 1.2&nbsp;<abbr>MB</abbr>,
<a href="mpfr-2.3.1.tar.gz.asc" title="PGP signature for mpfr-2.3.1.tar.gz">signature</a>),</li>
<li><a href="mpfr-2.3.1.zip">mpfr-2.3.1.zip</a>
(zip, 1.5&nbsp;<abbr>MB</abbr>,
<a href="mpfr-2.3.1.zip.asc" title="PGP signature for mpfr-2.3.1.zip">signature</a>).</li>
</ul>

<p><strong>Important note: If the <acronym>MPFR</acronym> build fails, please
read the section <cite>In case of problem</cite> of the <samp>INSTALL</samp>
file.</strong> In particular, <acronym>GMP</acronym> is known for using a
different <acronym title="Application Binary Interface">ABI</acronym> from
the default one on some 64-bit platforms, and in such a case, if you do not
provide the same compiler flags as those automatically selected by
<acronym>GMP</acronym>, things will probably go wrong, <abbr>e.g.</abbr>
<samp>libgmp not found</samp> error message at configure time (this error
message will be improved in future <acronym>MPFR</acronym> versions).</p>

<p><acronym>MPFR</acronym> is also available via
<a href="../ports.html">third-party packages and ports</a>.</p>

<h2 id="doc">Documentation</h2>

<ul>

<li>The reference manual:
[<a href="mpfr.html" title="Reference manual in HTML format">html</a>]
[<a href="mpfr.dvi.gz" title="Reference manual in DVI format">dvi</a>]
[<a href="mpfr.ps.gz" title="Reference manual in Postscript format">ps</a>]
[<a href="mpfr.pdf" title="Reference manual in PDF format">pdf</a>]</li>

<li>The <a href="../faq.html"><acronym>MPFR</acronym>
<acronym title="Frequently Asked Questions">FAQ</acronym></a>
(common to all <acronym>MPFR</acronym> versions).</li>

</ul>

<h2 id="bugs">Bugs</h2>

<p>The bugs <a href="#fixed">listed below</a> have been fixed (latest
update: 2008-05-11). The following instructions are for Linux and may
be similar for other operating systems. You can apply the patches in
several ways:</p>

<ul>

<li>Apply the <a href="patches">cumulative patch</a> on the 2.3.1 release
or a partially patched version with the command
<pre>patch -N -Z -p1 &lt; <var>path_to_patches_file</var></pre>
from the source directory. The <samp>-N</samp> option allows the
<samp>patch</samp> command to ignore patches already applied. The
<samp>-Z</samp> option sets the modification time of the patched files
from time stamps given in the patch file, thus avoiding the need of some
development utilities (such as <cite>autoconf</cite>); this may generate
a <q>Not setting time</q> warning for the <samp>PATCHES</samp> file, but
you can safely ignore it. Under Microsoft Windows, in addition to the
above options, you may need the <samp>--binary</samp> option (this depends
whether the end-of-lines have been converted when you downloaded the patch
file). Also note that the <samp>--dry-run</samp> option does not work with
this cumulative patch.</li>

<li>Or apply the individual patches below.</li>

<li>Or checkout the 2.3 branch from the Subversion repository,
<abbr>e.g.</abbr> with the command
<pre>svn co svn://scm.gforge.inria.fr/svn/mpfr/branches/2.3 mpfr-2.3</pre>
In this case, as said on the <a href="../gforge.html">Gforge page</a>, you
should read the <samp>README.dev</samp> file for details on how to build
<acronym>MPFR</acronym>. Also note that the branch may contain additional
minor fixes.</li>

</ul>

<p>With the first two ways, the <samp>PATCHES</samp> file is modified,
so that one can know what patches have been applied, using the new
<samp>mpfr_get_patches</samp> function. Moreover a suffix is added to
the version string, but note that for practical reasons, not all the
files where the version appears are patched; thus one can also track
applied patches with the <code>MPFR_VERSION_STRING</code> macro (header)
and the <code>mpfr_get_version</code> function (library). However, if
some patches are not applied or if patches are applied in a different
order, then the patch command will fail to update some chunks, so that
the suffix is not always reliable for patches.</p>

<p>Note: These patches are in unified diff format and some vendors'
<samp>patch</samp> commands cannot deal with them; in this case, please
use <a href="http://directory.fsf.org/project/patch/"><acronym>GNU</acronym>
patch</a> (it <em>may</em> already be installed on your system, e.g. as
<samp>/usr/local/bin/patch</samp> or <samp>gpatch</samp>).</p>

<p id="fixed">Fixed bugs:</p>

<ol>

<li id="p1"><p>The thread-safe configure test (enabled when the
<samp>--enable-thread-safe</samp> option is given) always fails when the
build directory is different from the source directory. This is fixed by
the <a href="patch01">thread-safe configure patch</a>.</p>
<p>Note that two files are patched: <samp>acinclude.m4</samp> and
<samp>configure</samp>, but the timestamp of <samp>acinclude.m4</samp> is
not updated (if the <samp>-Z</samp> <samp>patch</samp> option is given as
recommended above) to avoid the unnecessary rebuild of some files by
additional development tools (not always available).</p></li>

</ol>

<p>Some other bugs have been found and fixed both in the trunk and in
the 2.3 branch. The ones that may affect the user are listed below.
The corresponding patches are not published (these bugs will be fixed
in the upcoming 2.3.2 release), but the changeset numbers (in the 2.3
branch) are given for the reference.</p>

<ul>

<!--
  Update with:
    perl -pi -e '/\[Changesets?:/ && s! (\d+)!\n<a href="https://gforge.inria.fr/scm/viewvc.php?view=rev&amp;root=mpfr&amp;revision=\1">\1</a>!g' index.html
-->

<li>Functions <code>mpfr_pow_ui</code>, <code>mpfr_pow_si</code> and
<code>mpfr_pow_z</code> (but not <code>mpfr_pow</code>) on NaN^0 return NaN
instead of 1 (as documented, <acronym>MPFR</acronym>'s power functions are
based on the specifications of the <acronym>ISO</acronym> C99 standard).<br />
[Changeset:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=5426&amp;view=revision">5426</a>]</li>

<li>Underflow bug in function <code>mpfr_div</code>, which returns
+2<sup>emin&minus;1</sup> (<abbr>resp.</abbr> &minus;2<sup>emin&minus;1</sup>)
instead of +0 (<abbr>resp.</abbr> &minus;0) in rounding to nearest when
the rounded result in unbounded exponent range is ±2<sup>emin&minus;2</sup>
and the corresponding ternary value is positive (<abbr>resp.</abbr>
negative).<br />
[Changesets:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=5518&amp;view=revision">5518</a>,
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=5520&amp;view=revision">5520</a>]</li>

<li>Underflow bug due to double-rounding in functions
<code>mpfr_mul_2si</code>, <code>mpfr_div_2si</code> and
<code>mpfr_div_2ui</code>, which return +0 (<abbr>resp.</abbr> &minus;0)
instead of +2<sup>emin&minus;1</sup> (<abbr>resp.</abbr>
&minus;2<sup>emin&minus;1</sup>) in rounding to nearest when the rounded
result in unbounded exponent range is ±2<sup>emin&minus;2</sup> and the
corresponding ternary value is negative (<abbr>resp.</abbr> positive).<br />
[Changeset:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=5521&amp;view=revision">5521</a>]</li>

<li>Function <code>mpfr_exp</code> has the following problems:
<ul>
<li>Possible assertion failure due to a cancellation that occurs when the
input value <var>x</var> is very close to an integer multiple of log(2).
Note that if the input and the output parameters have the same precision
(most of the cases), then it is very unlikely that there exists a value
<var>x</var> that can trigger the bug; tests have been carried out on
32-bit and 64-bit platforms on the inputs that are the most likely to be
affected (precision &#8804; 200, round(<var>x</var> / log(2)) &#8804; 3000).<br />
Note: the bug is in <samp>exp_2.c</samp>, which is <em>not</em> used in
very high precisions, say &#8805; 50000.</li>
<li>Due to an incorrect error bound, one can get incorrectly rounded results
(see <code>bug20080731</code> in
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr/branches/2.3/tests/texp.c?revision=5526&amp;view=markup&amp;pathrev=5526"><samp>texp.c</samp></a>
for an example).<br />
Note: again, the bug is in <samp>exp_2.c</samp>, which is <em>not</em>
used in very high precisions.</li>
<li>Overflow/underflow detection/handling is incorrect.</li>
</ul>
[Changeset:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=5526&amp;view=revision">5526</a>]</li>

<li>In <code>mpfr_pow_si</code>, Ziv's iteration is done in a linear way
(old code) instead of the common way. This means a noticeable performance
loss in very special cases.<br />
[Changeset:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=5529&amp;view=revision">5529</a>]</li>

<li>The overflow flag can be lost in many functions called with the maximum
exponent equal to <code>MPFR_EMAX_MAX</code> (this is the default on 32-bit
platforms, but not on 64-bit platforms) when the temporary result (in a
higher precision) is representable but once rounded, it yields an overflow.
Most code is very unlikely to be affected by this bug.<br />
[Changeset:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=5546&amp;view=revision">5546</a>]</li>

<li><acronym>MPFR</acronym>'s  power functions (<code>mpfr_pow</code>,
<code>mpfr_pow_ui</code>, <code>mpfr_pow_si</code>, <code>mpfr_pow_z</code>)
have the following problems:
<ul>
<li>assertion failure on <code>mpfr_pow(z, x, y, rnd)</code> with integer
|y| &#8805; 2<sup>256</sup>, unless an overflow or underflow had been detected
first;</li>
<li>overflow/underflow detection/handling is incorrect (<abbr>e.g.</abbr>
possible spurious exceptions in case of internal overflow/underflow).</li>
</ul>
[Changesets:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=5558&amp;view=revision">5558</a>,
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=5562&amp;view=revision">5562</a>]</li>

<li>Function <code>mpfr_hypot</code> has the following problems:
<ul>
<li>the inexact flag is not always set as required;</li>
<li><code>mpfr_hypot</code> can loop on tiny values (due to
internal underflow);</li>
<li>in case of overflow, the overflow flag is not always set.</li>
</ul>
[Changeset:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=5568&amp;view=revision">5568</a>]</li>

<li>Possible assertion failure in the power functions, that can occur
in case of intermediate underflow or overflow.
[Changeset:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=5622&amp;view=revision">5622</a>]</li>

</ul>

<p id="unfixed">Other bugs: please see the <a href="https://gforge.inria.fr/scm/viewvc.php/tags/2.3.1/BUGS?view=markup&amp;root=mpfr&amp;pathrev=5233"><samp>BUGS</samp></a> file.</p>

<h2 id="changes">Changes from version 2.3.0 to version 2.3.1</h2>

<ul>

<li>Changes in the behavior of <code>mpfr_strtofr</code> and in
its documentation concerning particular cases where the code and
the documentation did not match.</li>

<li>Bug fixes; see the
<a href="../mpfr-2.3.0/#bugs"><acronym>MPFR</acronym> 2.3.0</a> page.</li>

<li>Configure test for <acronym title="Thread Local Storage">TLS</acronym>
support.</li>

<li>Improved <acronym>MPFR</acronym> manual.</li>

</ul>

<h2 id="platforms">Platforms Known to Support <cite><acronym>MPFR</acronym></cite></h2>

<p><cite><acronym>MPFR</acronym></cite> 2.3.1 has been successfully
compiled and checked on the following platforms:</p>

<ul>
<li><samp>alphaev56-unknown-linux-gnu</samp> (Alpha, <acronym>gcc</acronym> 4.1.2 prerelease),</li>
<li><samp>armv5tejl-unknown-linux-gnu</samp> (ARM926EJ-S rev 5, <acronym>gcc</acronym> 4.2.3, under <cite>qemu</cite>),</li>
<li><samp>armv5tel-unknown-linux-gnu</samp> (XScale-PXA255 rev 6, <acronym>gcc</acronym> 2.95.2),</li>
<li><samp>armv6l-unknown-linux-gnu</samp> (OMAP 2420 ARMv6-compatible processor rev 2, <acronym>gcc</acronym> 3.4.4),</li>
<li><samp>hppa2.0w-hp-hpux11.31</samp> (PA-RISC 8900, <acronym>HP</acronym> <acronym>cc</acronym> B.11.11.16),</li>
<li><samp>hppa2.0w-hp-hpux11.11</samp> (<acronym>gcc</acronym> 4.2.2),</li>
<li><samp>hppa64-hp-hpux11.11</samp> (<acronym>gcc</acronym> 4.2.2),</li>
<li><samp>i386-pc-mingw32</samp> (<acronym>gcc</acronym> 3.4.5),</li>
<li><samp>i386-unknown-freebsd6.2</samp> (Intel Pentium III, <acronym>gcc</acronym> 3.4.6),</li>
<li><samp>i386-unknown-openbsd4.2</samp> (Intel Pentium M, <acronym>gcc</acronym> 3.3.5),</li>
<li><samp>i686-apple-darwin9</samp> (Xeon, <acronym>gcc</acronym> 4.0.1 from XCode 3.0),</li>
<li><samp>i686-pc-cygwin</samp>,</li>
<li><samp>i686-pc-linux-gnu</samp> (Intel Pentium D, <acronym>gcc</acronym> 4.2.3 prerelease),</li>
<li><samp>ia64-unknown-linux-gnu</samp> (Itanium, <acronym>gcc</acronym> 4.1.2 prerelease),</li>
<li><samp>mips-sgi-irix5.3</samp> (o32 <acronym title="Application Binary Interface">ABI</acronym>, Irix 5.3 <acronym title="IRIS Development Option">IDO</acronym>),</li>
<li><samp>mips-sgi-irix6.2</samp> (n32 <acronym title="Application Binary Interface">ABI</acronym>, <acronym>gcc</acronym> 4.2.1),</li>
<li><samp>mips-sgi-irix6.2</samp> (n32 <acronym title="Application Binary Interface">ABI</acronym>, MIPSpro 7.30),</li>
<li><samp>mips-sgi-irix6.5</samp> (<acronym>gcc</acronym> 3.3),</li>
<li><samp>powerpc-apple-darwin8.11.0</samp> (PowerPC G5, <acronym>gcc</acronym> 4.0.1, 32 and 64 bits),</li>
<li><samp>powerpc-unknown-linux-gnu</samp> (PowerPC G4, <acronym>gcc</acronym> 4.2.3 prerelease),</li>
<li><samp>powerpc64-unknown-linux-gnu</samp> (POWER5, <acronym>gcc</acronym> 4.1.2 prerelease),</li>
<li><samp>sparc-sun-solaris2.7</samp> (UltraSPARC-II, Sun WorkShop 6 2000/04/07 C 5.1),</li>
<li><samp>sparc-sun-solaris2.9</samp> (UltraSPARC-III, <acronym>gcc</acronym> 4.2.1, 32 bits),</li>
<li><samp>sparc-sun-solaris2.10</samp> (UltraSPARC-II, Sun Studio 11, without <samp>-fast</samp>, 32 and 64 bits),</li>
<li><samp>x86_64-unknown-linux-gnu</samp> (<acronym>AMD</acronym> Opteron, <acronym>gcc</acronym> 4.1.2 prerelease),</li>
<li><samp>x86_64-unknown-linux-gnu</samp> (Intel Pentium D, <acronym>gcc</acronym> 4.2.3 prerelease),</li>
<li><samp>x86_64-unknown-linux-gnu</samp> (<acronym>AMD</acronym> Opteron, <acronym>icc</acronym> 10.1 20080312 with <samp>-fPIC</samp> added to <samp>$CFLAGS</samp>),</li>
<li><samp>x86_64-unknown-linux-gnu</samp> (<acronym>AMD</acronym> Opteron, Open64 Compiler Suite 4.1, no <acronym title="Thread Local Storage">TLS</acronym>),</li>
<li>Microsoft Windows, with Microsoft Visual Studio Professional 2008 (32 and 64 bits).</li>
</ul>

<p><a href="../index.html">Back to the <cite><acronym>MPFR</acronym></cite>
page.</a></p>

<hr />

<div class="footer"><a href="http://validator.w3.org/check/referer"><img
  src="http://www.w3.org/Icons/valid-xhtml10"
  alt="Valid XHTML 1.0!" height="31" width="88" /></a></div>

</body>

</html>
