<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>GNU MPFR version 2.4.1</title>
<link rel="shortcut icon" href="../favicon.ico" />
<link rel="stylesheet" type="text/css" href="../styles/screen.css" media="screen,tv,projection" />
<link rel="stylesheet" type="text/css" href="../styles/print.css" media="print" />
<link rel="top" title="The MPFR Library" href="../index.html" />
<link rel="up" title="The MPFR Library" href="../index.html" />
</head>

<body>

<div class="logo"><a href="../index.html"><img src="../mpfr100.png" height="40" width="100" alt="[MPFR]" /></a></div>

<h1><acronym>GNU</acronym> <acronym>MPFR</acronym> version 2.4.1
(released on 25 February 2009)</h1>

<div>[<a href="#download">download</a>]
[<a href="#doc">documentation</a>]
[<a href="#bugs">bugs</a>]
[<a href="#changes">changes</a>]
[<a href="#platforms">platforms</a>]
[<a href="../mpfr-2.4.0/timings.html" title="Comparison of other software to MPFR 2.4.0">timings of 2.4.0</a>]</div>

<p>The <em lang="fr" xml:lang="fr">andouillette sauce moutarde</em> release.</p>

<p><acronym>MPFR</acronym> 2.4.1 requires <acronym>GMP</acronym> 4.1.0
or higher (<acronym>GMP</acronym> 4.2.3 or higher is recommended).</p>

<h2 id="download">Download</h2>

<p>The <acronym>MPFR</acronym> 2.4.1 source can be downloaded in the
following archive formats:</p>
<ul>
<li><a href="mpfr-2.4.1.tar.lzma">mpfr-2.4.1.tar.lzma</a>
(tar/lzma, 883&nbsp;<abbr>KB</abbr>,
<a href="mpfr-2.4.1.tar.lzma.asc" title="PGP signature for mpfr-2.4.1.tar.lzma">signature</a>),</li>
<li><a href="mpfr-2.4.1.tar.bz2">mpfr-2.4.1.tar.bz2</a>
(tar/bzip2, 1.1&nbsp;<abbr>MB</abbr>,
<a href="mpfr-2.4.1.tar.bz2.asc" title="PGP signature for mpfr-2.4.1.tar.bz2">signature</a>),</li>
<li><a href="mpfr-2.4.1.tar.gz">mpfr-2.4.1.tar.gz</a>
(tar/gzip, 1.4&nbsp;<abbr>MB</abbr>,
<a href="mpfr-2.4.1.tar.gz.asc" title="PGP signature for mpfr-2.4.1.tar.gz">signature</a>),</li>
<li><a href="mpfr-2.4.1.zip">mpfr-2.4.1.zip</a>
(zip, 1.7&nbsp;<abbr>MB</abbr>,
<a href="mpfr-2.4.1.zip.asc" title="PGP signature for mpfr-2.4.1.zip">signature</a>).</li>
</ul>

<p><acronym>MPFR</acronym> is also available via
<a href="../ports.html">third-party packages and ports</a>.</p>

<h2 id="doc">Documentation</h2>

<ul>

<li>The reference manual:
[<a href="mpfr.html" title="Reference manual in HTML format">html</a>]
[<a href="mpfr.dvi.gz" title="Reference manual in DVI format">dvi</a>]
[<a href="mpfr.ps.gz" title="Reference manual in Postscript format">ps</a>]
[<a href="mpfr.pdf" title="Reference manual in PDF format">pdf</a>]</li>

<li>The <a href="../faq.html"><acronym>MPFR</acronym>
<acronym title="Frequently Asked Questions">FAQ</acronym></a>
(common to all <acronym>MPFR</acronym> versions).</li>

</ul>

<h2 id="bugs">Bugs</h2>

<p>The bugs <a href="#fixed">listed below</a> have been fixed (latest
update: 2009-03-13). The patches are distributed under the same license as
this version of <acronym>MPFR</acronym>, that is, the <acronym>GNU</acronym>
Lesser General Public License (<acronym>GNU</acronym> Lesser
<acronym>GPL</acronym>), version 2.1 or later. Note that patches
from the trunk (<em>not</em> listed on this page) are under the
<acronym>GNU</acronym> Lesser <acronym>GPL</acronym> version 3 or
later, thus may be backported <em>only</em> by the authors or the
<acronym title="Free Software Foundation">FSF</acronym> without
a license upgrade.</p>

<p>The following instructions are for Linux and may be similar for
other operating systems. You can apply the patches in several ways:</p>

<ul>

<li>Apply the <a href="patches">cumulative patch</a> on the 2.4.1 release
or a partially patched version with the command
<pre>patch -N -Z -p1 &lt; <var>path_to_patches_file</var></pre>
from the source directory. The <samp>-N</samp> option allows the
<samp>patch</samp> command to ignore patches already applied. The
<samp>-Z</samp> option sets the modification time of the patched files
from time stamps given in the patch file, thus avoiding the need of some
development utilities (such as <cite>autoconf</cite>); this may generate
a <q>Not setting time</q> warning for the <samp>PATCHES</samp> file, but
you can safely ignore it. Under Microsoft Windows, in addition to the
above options, you may need the <samp>--binary</samp> option (this depends
whether the end-of-lines have been converted when you downloaded the patch
file). Also note that the <samp>--dry-run</samp> option does not work with
this cumulative patch.</li>

<li>Or apply the individual patches below.</li>

<li>Or checkout the 2.4 branch from the Subversion repository,
<abbr>e.g.</abbr> with the command
<pre>svn co svn://scm.gforge.inria.fr/svn/mpfr/branches/2.4 mpfr-2.4</pre>
In this case, as said on the <a href="../gforge.html">Gforge page</a>, you
should read the <samp>README.dev</samp> file for details on how to build
<acronym>MPFR</acronym>. Also note that the branch may contain additional
minor fixes.</li>

</ul>

<p>With the first two ways, the <samp>PATCHES</samp> file is modified,
so that one can know what patches have been applied, using the new
<samp>mpfr_get_patches</samp> function. Moreover a suffix is added to
the version string, but note that for practical reasons, not all the
files where the version appears are patched; thus one can also track
applied patches with the <code>MPFR_VERSION_STRING</code> macro (header)
and the <code>mpfr_get_version</code> function (library). However, if
some patches are not applied or if patches are applied in a different
order, then the patch command will fail to update some chunks, so that
the suffix is not always reliable for patches.</p>

<p>Note: These patches are in unified diff format and some vendors'
<samp>patch</samp> commands cannot deal with them; in this case, please
use <a href="http://directory.fsf.org/patch.html"><acronym>GNU</acronym>
patch</a> (it <em>may</em> already be installed on your system, e.g. as
<samp>/usr/local/bin/patch</samp> or <samp>gpatch</samp>).</p>

<p id="fixed">Fixed bugs:</p>

<ol>

<li id="p1">The remainder functions (<code>mpfr_fmod</code>,
<code>mpfr_remainder</code> and <code>mpfr_remquo</code>) round
the result before changing its sign when <var>x</var> is negative.
The consequence is that in non-symmetric rounding modes
(<code>GMP_RNDD</code> and <code>GMP_RNDU</code>), the result
is rounded in the wrong direction. This bug is fixed in the
<a href="patch01"><samp>remainder-neg</samp> patch</a>.</li>

<li id="p2">Assertion failure messages do not mention
<acronym>MPFR</acronym> explicitly. This is fixed in the
<a href="patch02"><samp>assert</samp> patch</a>.</li>

<li id="p3">In the tests: <a href="patch03">patch adding casts to
<code>void *</code></a> for <samp>%p</samp> in <code>printf</code>
format. Most (if not all) C implementations should not be affected
by these missing casts.</li>

<li id="p4">A type is incorrect in the <samp>vasprintf.c</samp> file.
In practice, this can make <acronym>MPFR</acronym> crash when the
<samp>M</samp> specifier (for the formatted output functions) is
used <em>and</em> a limb does not have the same size as a pointer
(<abbr>e.g.</abbr> when <acronym>GMP</acronym> has been built with
<samp>ABI=mode32</samp> on PowerPC G5). This bug is fixed in the
<a href="patch04"><samp>vasprintf-mp_limb_t</samp> patch</a>.
Note: the tests from <acronym>MPFR</acronym> 2.4.1 already contain
a testcase in the <samp>tests/tfprintf.c</samp> file.</li>

<li id="p5">If a limb does not have the same size as an
<code>unsigned long</code>, a shift count is incorrect in
<code>mpfr_zeta_ui</code>. In such a case, the practical consequence
is a possible performance loss. An incorrect result is theoretically
possible (<abbr>e.g.</abbr> if the compiler optimizes out parts of code
with undefined behavior), but unlikely in practice. This bug is fixed
in the <a href="patch05"><samp>zeta_ui-shift</samp> patch</a>.</li>

</ol>

<p>Some other bugs have been found and fixed both in the trunk and in
the 2.4 branch. The ones that may affect the user are listed below.
The corresponding patches are not published (these bugs will be fixed
in the upcoming 2.4.2 release), but the changeset numbers (in the 2.4
branch) are given for the reference.</p>

<ul>

<!--
  Update with:
    perl -pi -e '/\[Changesets?:/ && s! (\d+)!\n<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=\1&amp;root=mpfr&amp;view=rev">\1</a>!g' index.html
-->

<li>Use of non-portable shell constructs can make <samp>configure</samp>
fail, <abbr>e.g.</abbr> on HP-UX.<br />
[Changeset:
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6127&amp;root=mpfr&amp;view=rev">6127</a>]</li>

<li>A test in <samp>texp.c</samp> is incorrect: a spurious test failure
occurs if the user sets <code>MPFR_EXP_THRESHOLD</code> to a very small
value in <samp>mparam.h</samp> (<abbr>e.g.</abbr> by tuning
<acronym>MPFR</acronym>).<br />
[Changeset:
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6198&amp;root=mpfr&amp;view=rev">6198</a>]</li>

<li>On platforms where <code>long double</code> corresponds to the x87
extended-precision format, <code>mpfr_get_ld</code> does not correctly
handle the subnormal range (possible assertion failure) and the maximum
exponent value is too small by one.<br />
[Changeset:
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6204&amp;root=mpfr&amp;view=rev">6204</a>]</li>

<li>When the source and build directories are different, the tests can
fail if the source directory contains some special words or a comma
(due to a lack of robustness in the use of the C preprocessor).<br />
[Changeset:
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6213&amp;root=mpfr&amp;view=rev">6213</a>]</li>

<li>Function <code>mpfr_atan</code> has the following problems:
<ul>
<li>Crash with argument very near to but different from 1.</li>
<li>In some very particular and extremely reduced exponent range,
spurious overflow on ±1 and ±Inf.</li>
</ul>
Note: <code>mpfr_atan2</code> calls <code>mpfr_atan</code>, thus is
affected too.<br />
[Changeset:
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6214&amp;root=mpfr&amp;view=rev">6214</a>]</li>

<li><samp>&lt;string.h&gt;</samp> is not automatically included when
building <acronym>MPFR</acronym> with <samp>--with-gmp-build</samp>, though
it is needed by some files. This may result in incorrect build.<br />
[Changeset:
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6216&amp;root=mpfr&amp;view=rev">6216</a>]</li>

<li>Various bugs and portability problems in the formatted output functions
(<samp>mpfr_*printf</samp>). In particular, a buffer overflow is possible
when the precision field is a multiple of 4096 minus 1 (see
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6112&amp;root=mpfr&amp;view=rev">changeset
6112</a> from the trunk), and the conversion specifier <samp>G</samp> yields
incorrect output.<br />
[Changesets:
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6218&amp;root=mpfr&amp;view=rev">6218</a>,
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6219&amp;root=mpfr&amp;view=rev">6219</a>,
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6221&amp;root=mpfr&amp;view=rev">6221</a>,
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6222&amp;root=mpfr&amp;view=rev">6222</a>,
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6223&amp;root=mpfr&amp;view=rev">6223</a>,
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6224&amp;root=mpfr&amp;view=rev">6224</a>]</li>

<li>Major bug in <code>mpfr_fmod</code>, which can return an
incorrect result, probably frequently. For more information, see the
<a href="http://thread.gmane.org/gmane.comp.lib.mpfr.general/114">explanations
by Eric Veach</a>, who reported the bug.<br />
[Changeset:
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6235&amp;root=mpfr&amp;view=rev">6235</a>]</li>

<li>If <acronym>MPFR</acronym> has been built with decimal support and
<code>mpfr_exp_t</code> does not have the same size as a <code>long int</code>,
<code>mpfr_get_decimal64</code> can behave incorrectly.<br />
[Changeset:
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6250&amp;root=mpfr&amp;view=rev">6250</a>]</li>

<li>The <samp>configure</samp> test <cite><acronym>gcc</acronym>
float-conversion bug</cite> does not work on some platforms (because of
aggressive optimizations). The following patch improves the portability.<br />
[Changeset:
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6273&amp;root=mpfr&amp;view=rev">6273</a>]</li>

<li>The function <code>mpfr_coth</code> is wrong on ±0.<br />
[Changeset:
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6338&amp;root=mpfr&amp;view=rev">6338</a>]</li>

<li>Other bugs in the formatted output functions (<samp>mpfr_*printf</samp>):
<samp>%%</samp> in the format string outputs % twice instead of once.
Output may be wrong when the value to display is rounded up to the next
power of the base.
<samp>%.0Rb</samp> is not supported (the precision is increased to 1).
For <samp>%Rg</samp> (no explicit precision), the <acronym>MPFR</acronym>
manual is incorrect: the default precision is 6.
<samp>%Rf</samp> (no explicit precision) is not completely specified;
because this makes more sense, the behavior will change in
<acronym>MPFR</acronym> 2.4.2, with a default precision equal to 6.<br />
[Changesets:
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6262&amp;root=mpfr&amp;view=rev">6262</a>,
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6281&amp;root=mpfr&amp;view=rev">6281</a>,
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6284&amp;root=mpfr&amp;view=rev">6284</a>,
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6299&amp;root=mpfr&amp;view=rev">6299</a>,
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6302&amp;root=mpfr&amp;view=rev">6302</a>,
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6304&amp;root=mpfr&amp;view=rev">6304</a>,
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6331&amp;root=mpfr&amp;view=rev">6331</a>,
<a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php?rev=6341&amp;root=mpfr&amp;view=rev">6341</a>]</li>

</ul>

<p id="unfixed">Other bugs: please see the <a href="https://gforge.inria.fr/tracker/?group_id=136">tracker</a> and the <a href="https://gforge.inria.fr/plugins/scmsvn/viewcvs.php/tags/2.4.1/BUGS?rev=6012&amp;root=mpfr&amp;view=markup"><samp>BUGS</samp></a> file.</p>

<p>Note: Under <acronym>HP-UX</acronym>, you may need to install
<acronym>MPFR</acronym> before running <code>make check</code>. Indeed the
<cite>libtool</cite> scripts included in the <acronym>MPFR</acronym> tarball
(based on <cite>libtool</cite> 2.2) seem to have a bug: for the tests, the
install directory (which may already contain an older <acronym>MPFR</acronym>
version) has the precedence over the build directory.</p>

<h2 id="changes">Changes from version 2.4.0 to version 2.4.1</h2>

<ul>

<li>Security fix in <code>mpfr_snprintf</code> and <code>mpfr_vsnprintf</code>
(buffer overflow).</li>

<li>Configure: new checks for length modifiers <samp>hh</samp>
and <samp>ll</samp> (new in C99) as <samp>hh</samp> is absent
on <samp>alpha-OSF1-V5</samp>.</li>

<li>Miscellaneous corrections in the <acronym>MPFR</acronym> manual.
In particular, <code>mpfr_inits</code>, <code>mpfr_inits2</code>,
<code>mpfr_clears</code> and <code>MPFR_DECL_INIT</code> have been in
the public <acronym title="Application Program Interface">API</acronym>
since <acronym>MPFR</acronym> 2.4.0.</li>

</ul>

<p><a href="../mpfr-2.4.0/index.html#changes">Changes in <acronym>MPFR</acronym> 2.4.0</a>.</p>

<h2 id="platforms">Platforms Known to Support <cite><acronym>MPFR</acronym></cite></h2>

<p><cite><acronym>MPFR</acronym></cite> 2.4.1 has been successfully
compiled and checked on the following platforms:</p>

<ul>
<li><samp>armv5tel-unknown-linux-gnueabi</samp> (<acronym>ARM</acronym>, <acronym>gcc</acronym> 4.1.2),</li>
<li><samp>armv6l-unknown-linux-gnueabi</samp> (OMAP 2420 ARMv6-compatible processor rev 2, <acronym>gcc</acronym> 3.4.4),</li>
<li><samp>hppa2.0-unknown-linux-gnu</samp> (<acronym>gcc</acronym> 4.3.2),</li>
<li><samp>i386-apple-darwin9.6.0</samp> (<acronym>gcc</acronym> 4.0.1),</li>
<li><samp>i386-pc-solaris2.8</samp> (Sun Studio 11),</li>
<li><samp>i386-pc-solaris2.10</samp> (Intel Xeon, <acronym>gcc</acronym> 3.4.6),</li>
<li><samp>i686-pc-linux-gnu</samp> (<acronym>gcc</acronym> 4.1.2 and 4.3.2, <acronym>icc</acronym> 11.0, and Sun C 5.9 Linux_i386 Patch 124871-01 2007/07/31),</li>
<li><samp>i686-pc-solaris2.11</samp> (Sun Studio 12),</li>
<li><samp>ia64-unknown-linux-gnu</samp> (Itanium, <acronym>gcc</acronym> 4.1.2, 4.3.0 and 4.3.2, and <acronym>icc</acronym> 10.1 and 11.0),</li>
<li><samp>mips64el-unknown-linux-gnu</samp> (<acronym>gcc</acronym> 4.3.2),</li>
<li><samp>powerpc-apple-darwin8.11.0</samp> (PowerPC G5, <acronym>gcc</acronym> 4.0.1, 32 and 64 bits),</li>
<li><samp>powerpc-unknown-linux-gnu</samp> (PowerPC G4, <acronym>gcc</acronym> 4.3.3),</li>
<li><samp>powerpc64-unknown-linux-gnu</samp> (POWER5, <acronym>gcc</acronym> 4.1.2 prerelease),</li>
<li><samp>x86_64-pc-solaris2.11</samp> (Sun Studio 12),</li>
<li><samp>x86_64-unknown-linux-gnu</samp> (<acronym>gcc</acronym> 4.1.2, 4.3.2 and 4.3.3, <acronym>opencc</acronym> 4.1, and <acronym>icc</acronym> 11.0),</li>
<li>Microsoft Windows (Vista Ultimate x64), with Microsoft Visual Studio 2008 (32 and 64 bits).</li>
</ul>

<p><a href="../index.html">Back to the <cite><acronym>MPFR</acronym></cite>
page.</a></p>

<hr />

<div class="footer"><a href="http://validator.w3.org/check/referer"><img
  src="http://www.w3.org/Icons/valid-xhtml10"
  alt="Valid XHTML 1.0!" height="31" width="88" /></a></div>

</body>

</html>
