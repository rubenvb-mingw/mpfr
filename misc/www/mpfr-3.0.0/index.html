<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>GNU MPFR version 3.0.0</title>
<link rel="shortcut icon" href="../favicon.ico" />
<link rel="stylesheet" type="text/css" href="../styles/screen.css" media="screen,tv,projection" />
<link rel="stylesheet" type="text/css" href="../styles/print.css" media="print" />
<link rel="top" title="The GNU MPFR Library" href="../index.html" />
<link rel="up" title="The GNU MPFR Library" href="../index.html" />
</head>

<body>

<div class="logo"><a href="../index.html"><img src="../mpfr100.png" height="40" width="100" alt="[MPFR]" /></a></div>

<h1><acronym>GNU</acronym> <acronym>MPFR</acronym> version 3.0.0
(released on 10 June 2010)</h1>

<div>[<a href="#download">download</a>]
[<a href="#doc">documentation</a>]
[<a href="#bugs">bugs</a>]
[<a href="#changes">changes</a>]
[<a href="#platforms">platforms</a>]</div>

<p>The <cite lang="fr" xml:lang="fr">boudin aux pommes</cite> release.</p>

<p><acronym>MPFR</acronym> 3.0.0 requires <acronym>GMP</acronym> 4.1.0
or higher (<acronym>GMP</acronym> 4.2.3 or higher is recommended).</p>

<h2 id="download">Download</h2>

<p>The <acronym>MPFR</acronym> 3.0.0 source can be downloaded in the
following archive formats:</p>
<ul>
<li><a href="mpfr-3.0.0.tar.xz">mpfr-3.0.0.tar.xz</a>
(tar/xz, 978 <abbr>KB</abbr>,
<a href="mpfr-3.0.0.tar.xz.asc" title="PGP signature for mpfr-3.0.0.tar.xz">signature</a>),</li>
<li><a href="mpfr-3.0.0.tar.bz2">mpfr-3.0.0.tar.bz2</a>
(tar/bzip2, 1.1 <abbr>MB</abbr>,
<a href="mpfr-3.0.0.tar.bz2.asc" title="PGP signature for mpfr-3.0.0.tar.bz2">signature</a>),</li>
<li><a href="mpfr-3.0.0.tar.gz">mpfr-3.0.0.tar.gz</a>
(tar/gzip, 1.4 <abbr>MB</abbr>,
<a href="mpfr-3.0.0.tar.gz.asc" title="PGP signature for mpfr-3.0.0.tar.gz">signature</a>),</li>
<li><a href="mpfr-3.0.0.zip">mpfr-3.0.0.zip</a>
(zip, 1.8 <abbr>MB</abbr>,
<a href="mpfr-3.0.0.zip.asc" title="PGP signature for mpfr-3.0.0.zip">signature</a>).</li>
</ul>

<p><acronym>MPFR</acronym> is also available via
<a href="../ports.html">third-party packages and ports</a>.</p>

<h2 id="doc">Documentation</h2>

<ul>

<li>The reference manual:
[<a href="mpfr.html" title="Reference manual in HTML format">html</a>]
[<a href="mpfr.dvi.gz" title="Reference manual in DVI format">dvi</a>]
[<a href="mpfr.ps.gz" title="Reference manual in Postscript format">ps</a>]
[<a href="mpfr.pdf" title="Reference manual in PDF format">pdf</a>]</li>

<li>The <a href="../faq.html"><acronym>MPFR</acronym>
<acronym title="Frequently Asked Questions">FAQ</acronym></a>
(common to all <acronym>MPFR</acronym> versions).</li>

</ul>

<h2 id="bugs">Bugs</h2>

<p>The bugs <a href="#fixed">listed below</a> have been fixed (latest
update: 2010-07-10). The patches are distributed under the same license as
this version of <acronym>MPFR</acronym>, that is, the <acronym>GNU</acronym>
Lesser General Public License (<acronym>GNU</acronym> Lesser
<acronym>GPL</acronym>), version 3 or later.</p>

<p>The following instructions are for Linux and may be similar for
other operating systems. You can apply the patches in several ways:</p>

<ul>

<li>Apply the <a href="allpatches">cumulative patch</a> on the
3.0.0 release or a partially patched version with the command
<pre>patch -N -Z -p1 &lt; <var>path_to_patches_file</var></pre>
from the source directory. The <samp>-N</samp> option allows the
<samp>patch</samp> command to ignore patches already applied. The
<samp>-Z</samp> option sets the modification time of the patched files
from time stamps given in the patch file, thus avoiding the need of some
development utilities (such as <cite>autoconf</cite>); this may generate
a <q>Not setting time</q> warning for the <samp>PATCHES</samp> file, but
you can safely ignore it. Under Microsoft Windows, in addition to the
above options, you may need the <samp>--binary</samp> option (this depends
whether the end-of-lines have been converted when you downloaded the patch
file). Also note that the <samp>--dry-run</samp> option does not work with
this cumulative patch.</li>

<li>Or apply the individual patches below.</li>

<li>Or checkout the 3.0 branch from the Subversion repository,
<abbr>e.g.</abbr> with the command
<pre>svn co svn://scm.gforge.inria.fr/svn/mpfr/branches/3.0 mpfr-3.0</pre>
In this case, as said on the <a href="../gforge.html">Gforge page</a>, you
should read the <samp>README.dev</samp> file for details on how to build
<acronym>MPFR</acronym>. Also note that the branch may contain additional
minor fixes.</li>

</ul>

<p>With the first two ways, the <samp>PATCHES</samp> file is modified,
so that one can know what patches have been applied, using the new
<samp>mpfr_get_patches</samp> function. Moreover a suffix is added to
the version string, but note that for practical reasons, not all the
files where the version appears are patched; thus one can also track
applied patches with the <code>MPFR_VERSION_STRING</code> macro (header)
and the <code>mpfr_get_version</code> function (library). However, if
some patches are not applied or if patches are applied in a different
order, then the patch command will fail to update some chunks, so that
the suffix is not always reliable for patches.</p>

<p>Note: These patches are in unified diff format and some vendors'
<samp>patch</samp> commands cannot deal with them; in this case, please
use <a href="http://directory.fsf.org/patch.html"><acronym>GNU</acronym>
patch</a> (it <em>may</em> already be installed on your system, e.g. as
<samp>/usr/local/bin/patch</samp> or <samp>gpatch</samp>).</p>

<p id="fixed">Fixed bugs:</p>

<ol>

<li id="p1">The integer value returned by the <code>mpfr_out_str</code>
function is incorrect on NaN and infinities. Moreover output errors
are not handled, and if such an error occurs, the return value is
incorrect (it should have been 0). These bugs are fixed by the
<a href="patch01"><samp>mpfr_out_str</samp> patch</a> (which also
provides additional tests of <code>mpfr_out_str</code>).</li>

<li id="p2">On some environments such as Solaris with Sun's compiler,
<acronym>MPFR</acronym> is not built correctly; this can be seen
with <samp>make check</samp>, where a typical error is the symbol
<samp>alloca</samp> being undefined. The real reason of this failure is
that <code>HAVE_ALLOCA_H</code> is not defined. This problem has been
introduced in <acronym>MPFR</acronym> 3.0.0.
It is fixed in the <a href="patch02"><samp>alloca</samp> patch</a>.</li>

<li id="p3">The underflow detection in <code>mpfr_gamma</code> is incorrect.
A possible consequence is that the function can freeze. This bug is fixed
by the <a href="patch03"><samp>gamma_underflow</samp> patch</a> (which also
provides a testcase for 32-bit machines).</li>

</ol>

<p>On some platforms (typically non-64-bit ones), <code>mpfr_get_sj</code> can have the following problem. If the resulting integer is a non-zero value that is small enough in absolute value, then the function can perform a right shift with a shift count larger than or equal to the width of the left operand; this has an undefined behavior. However such a shifted value is always 0 here, so that most current platforms (if not all) should be unaffected by this problem (except if compiler features to dynamically detect undefined behavior are used). This problem is <a href="https://gforge.inria.fr/scm/viewvc.php?view=rev&amp;root=mpfr&amp;revision=7047">fixed in the trunk (r7047)</a>.</p>

<!-- For BUGS, it's better to point to HEAD, as changes will be noted above. -->
<p id="unfixed">Other bugs: please see the <a href="https://gforge.inria.fr/tracker/?group_id=136">tracker</a> and the <a href="https://gforge.inria.fr/scm/viewvc.php/trunk/BUGS?view=markup&amp;root=mpfr"><samp>BUGS</samp></a> file.</p>

<p>Note: if you are trying to build <acronym>GCC</acronym> and get the error <q>header files gmp-impl.h and longlong.h not found</q>, please look at <a href="http://gcc.gnu.org/bugzilla/show_bug.cgi?id=44455" title="GCC fails to build if MPFR 3.0.0 (Release Candidate) is used"><acronym>GCC</acronym> bug 44455</a>. This problem is a consequence of a <a href="#gmp-build">correction in the detection of a <acronym>GMP</acronym> build directory</a>.</p>

<h2 id="changes">Changes from versions 2.4.* to version 3.0.0</h2>

<ul>

<li><acronym>MPFR</acronym> 3.0.0 is binary incompatible with previous versions
but (almost) <acronym title="Application Program Interface">API</acronym>
compatible. More precisely the obsolete functions <code>mpfr_random</code>
and <code>mpfr_random2</code> have been removed, the meaning of the return
type of the function <code>mpfr_get_f</code> has changed, and the return type
of the function <code>mpfr_get_z</code> is now <code>int</code> instead of
<code>void</code>. In practice, this should not break any existing code.</li>

<li><acronym>MPFR</acronym> is now distributed under the
<a href="http://www.gnu.org/licenses/lgpl-3.0.html"><acronym>GNU</acronym>
Lesser General Public License version 3</a> or later
(<acronym title="Lesser General Public License">LGPL</acronym> v3+).</li>

<li>Rounding modes <samp>GMP_RND<em>x</em></samp> are now
<samp>MPFR_RND<em>x</em></samp> (<samp>GMP_RND<em>x</em></samp>
kept for compatibility).</li>

<li>A new rounding mode (<code>MPFR_RNDA</code>) is available to round away
from zero.</li>

<li>The rounding mode type is now <code>mpfr_rnd_t</code> (as in previous
versions, both <code>mpfr_rnd_t</code> and <code>mp_rnd_t</code> are
accepted, but <code>mp_rnd_t</code> may be removed in the future).</li>

<li>The precision type is now <code>mpfr_prec_t</code> (as in previous
versions, both <code>mpfr_prec_t</code> and <code>mp_prec_t</code> are
accepted, but <code>mp_prec_t</code> may be removed in the future) and
it is now signed (it was unsigned in <acronym>MPFR</acronym> 2.*, but
this was not documented). In practice, this change should not affect
existing code that assumed nothing on the precision type.</li>

<li><acronym>MPFR</acronym> now has its own exponent type
<code>mpfr_exp_t</code>, which is currently the same as
<acronym>GMP</acronym>'s <code>mp_exp_t</code>.</li>

<li>Functions <code>mpfr_random</code> and <code>mpfr_random2</code>
have been removed.</li>

<li><code>mpfr_get_f</code> and <code>mpfr_get_z</code> now return a
ternary value.</li>

<li><code>mpfr_strtofr</code> now accepts bases from 37 to 62.</li>

<li><code>mpfr_custom_get_mantissa</code> was renamed to
<code>mpfr_custom_get_significand</code>
(<code>mpfr_custom_get_mantissa</code> is still available
via a <code>#define</code>).</li>

<li>Functions <code>mpfr_get_si</code>, <code>mpfr_get_ui</code>,
<code>mpfr_get_sj</code>, <code>mpfr_get_uj</code>, <code>mpfr_get_z</code>
and <code>mpfr_get_z_2exp</code> no longer have cases with undefined
behavior; in these cases, the behavior is now specified, and in
particular, the <em>erange</em> flag is set.</li>

<li>New functions <code>mpfr_buildopt_tls_p</code> and
<code>mpfr_buildopt_decimal_p</code> giving information
about options used at <acronym>MPFR</acronym> build time.</li>

<li>New function <code>mpfr_regular_p</code>.</li>

<li>New function <code>mpfr_set_zero</code>.</li>

<li>New function <code>mpfr_digamma</code>.</li>

<li>New function <code>mpfr_ai</code> (incomplete, experimental).</li>

<li>New functions <code>mpfr_set_flt</code> and <code>mpfr_get_flt</code>
to convert from/to the <code>float</code> type.</li>

<li>New function <code>mpfr_urandom</code>.</li>

<li>New function <code>mpfr_set_z_2exp</code> (companion to
<code>mpfr_get_z_2exp</code>, which was renamed from
<code>mpfr_get_z_exp</code> in previous versions).</li>

<li>Speed improvement for large operands in the trigonometric functions
(<code>mpfr_sin</code>, <code>mpfr_cos</code>, <code>mpfr_tan</code>,
<code>mpfr_sin_cos</code>): speedup of about 2.5 for 10<sup>5</sup> digits,
of about 5 for 10<sup>6</sup> digits.</li>

<li>Speed improvement for large operands of the inverse trigonometric
functions (<code>arcsin</code>, <code>arccos</code>, <code>arctan</code>):
about 2 for 10<sup>3</sup> digits, up to 2.7 for 10<sup>6</sup> digits.</li>

<li>Some documentation files are installed in <samp>$docdir</samp>.</li>

<li id="gmp-build">The detection of a <acronym>GMP</acronym> build directory
(more precisely, the internal header files of <acronym>GMP</acronym>) was
previously done separately from the use of the <samp>--with-gmp-build</samp>
configure option. This was not consistent with the documentation and with
other parts of the configure script. So, as of <acronym>MPFR</acronym> 3.0.0,
the internal header files of <acronym>GMP</acronym> are now used if and only
if the <samp>--with-gmp-build</samp> configure option is given.</li>

<li>The <samp>configure</samp> script recognizes some extra
<code>long double</code> formats (double big endian, double little endian,
double-double big endian).</li>

<li><acronym>MPFR</acronym> manual: added <cite>API Compatibility</cite>
section.</li>

<li>Test coverage: 97.1% lines of code.</li>

<li>Bug fixes.</li>

</ul>

<h2 id="platforms">Platforms Known to Support <cite><acronym>MPFR</acronym></cite></h2>

<p><cite><acronym>MPFR</acronym></cite> 3.0.0 has been successfully
compiled and checked on the following platforms:</p>

<ul>
<li><samp>armv5tel-unknown-linux-gnueabi</samp> (<acronym>gcc</acronym> 4.1.2),</li>
<li><samp>armv6l-unknown-linux-gnueabi</samp> (<acronym>gcc</acronym> 3.4.4),</li>
<li><samp>armv7l-unknown-linux-gnueabi</samp> (<acronym>gcc</acronym> 4.4.1),</li>
<li><samp>i386-pc-solaris2.10</samp> (Sun C 5.8 Patch 121016-08 2009/04/20 and Sun C 5.9 SunOS_i386 Patch 124868-10 2009/04/30),</li>
<li><samp>i686-pc-cygwin</samp> (<acronym>gcc</acronym> 3.4.4 and 4.3.4),</li>
<li><samp>i686-pc-linux-gnu</samp> (<acronym>gcc</acronym> 4.1.2 and 4.4.4, and <acronym>icc</acronym> 11.0),</li>
<li><samp>i686-pc-mingw32</samp> (<acronym>gcc</acronym> 3.4.5),</li>
<li><samp>ia64-unknown-linux-gnu</samp> (<acronym>gcc</acronym> 4.3.0 and 4.3.2),</li>
<li><samp>mips64el-unknown-linux-gnu</samp> (<acronym>gcc</acronym> 4.3.2),</li>
<li><samp>powerpc-apple-darwin8.11.0</samp> (PowerPC G5, <acronym>gcc</acronym> 4.0.1, 32 and 64 bits),</li>
<li><samp>powerpc-unknown-linux-gnu</samp> (PowerPC G4, <acronym>gcc</acronym> 4.4.3),</li>
<li><samp>x86_64-unknown-freebsd8.0</samp> (<acronym>gcc</acronym> 4.2.1),</li>
<li><samp>x86_64-unknown-linux-gnu</samp> (<acronym>gcc</acronym> 4.3.2, 4.3.5, 4.4.3, 4.4.4 and 4.6 snapshot, g++ 4.4.4, <acronym>opencc</acronym> 4.1, <acronym>llvm-gcc</acronym> 4.2.1, and <acronym>icc</acronym> 11.0).</li>
</ul>

<p><a href="../index.html">Back to the <cite><acronym>MPFR</acronym></cite>
page.</a></p>

<hr />

<div class="footer"><a href="http://validator.w3.org/check/referer"><img
  src="http://www.w3.org/Icons/valid-xhtml10"
  alt="Valid XHTML 1.0!" height="31" width="88" /></a></div>

</body>

</html>
