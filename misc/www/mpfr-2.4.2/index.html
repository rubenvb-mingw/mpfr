<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>GNU MPFR version 2.4.2</title>
<link rel="shortcut icon" href="../favicon.ico" />
<link rel="stylesheet" type="text/css" href="../styles/screen.css" media="screen,tv,projection" />
<link rel="stylesheet" type="text/css" href="../styles/print.css" media="print" />
<link rel="top" title="The GNU MPFR Library" href="../index.html" />
<link rel="up" title="The GNU MPFR Library" href="../index.html" />
</head>

<body>

<div class="logo"><a href="../index.html"><img src="../mpfr100.png" height="40" width="100" alt="[MPFR]" /></a></div>

<h1><acronym>GNU</acronym> <acronym>MPFR</acronym> version 2.4.2
(released on 30 November 2009)</h1>

<div>[<a href="#download">download</a>]
[<a href="#doc">documentation</a>]
[<a href="#bugs">bugs</a>]
[<a href="#changes">changes</a>]
[<a href="#platforms">platforms</a>]
[<a href="../mpfr-2.4.0/timings.html" title="Comparison of other software to MPFR 2.4.0">timings of 2.4.0</a>]</div>

<p>The <cite lang="fr" xml:lang="fr">andouillette sauce moutarde</cite> release,
patch level 2.</p>

<p><acronym>MPFR</acronym> 2.4.2 requires <acronym>GMP</acronym> 4.1.0
or higher (<acronym>GMP</acronym> 4.2.3 or higher is recommended).</p>

<p>This is the latest version of the 2.4 branch, which is no longer supported
(major bugs will be fixed for some time as patches only). Please upgrade to
<acronym>MPFR</acronym> 3.0.0 (or higher, when new versions are released):
<a href="http://www.mpfr.org/mpfr-current/">latest <acronym>MPFR</acronym>
release</a>.</p>

<p><strong>Warning! <acronym>GCC</acronym> 4.4.0 miscompiles
<acronym>MPFR</acronym> 2.4.2.</strong> This is detected by
<q><samp>make check</samp></q> (failures in <samp>tget_z</samp>
and <samp>tpow_all</samp>). Please use a different compiler;
note that only <acronym>GCC</acronym> 4.4.0 is affected; the
bug has been fixed in <acronym>GCC</acronym> 4.4.1.</p>

<p><strong>Warning! On Solaris, <acronym>MPFR</acronym> 2.4.2 can be
miscompiled with <acronym>GCC</acronym>.</strong> This is in fact a
bug in the Solaris <code>memset</code> function, which has been fixed
by Sun in October 2009. For more information about this bug, see this
<a href="http://gcc.gnu.org/bugzilla/show_bug.cgi?id=40757" title="gcc 4.4.0 miscompiles mpfr-2.4.1">bug report</a>
and this
<a href="http://groups.google.com/group/sage-devel/browse_thread/thread/75962dd6d45f7ab0" title="sage-devel thread about the Solaris memset bug">thread</a>.
See also <a href="http://groups.google.com/group/sage-devel/browse_thread/thread/3932945c46d3f536" title="sage-devel thread about the fix of the Solaris memset bug">information
about the fix</a>.</p>

<h2 id="download">Download</h2>

<p>The <acronym>MPFR</acronym> 2.4.2 source can be downloaded in the
following archive formats:</p>
<ul>
<li><a href="mpfr-2.4.2.tar.xz">mpfr-2.4.2.tar.xz</a>
(tar/xz, 930 <abbr>KB</abbr>,
<a href="mpfr-2.4.2.tar.xz.asc" title="PGP signature for mpfr-2.4.2.tar.xz">signature</a>),</li>
<li><a href="mpfr-2.4.2.tar.bz2">mpfr-2.4.2.tar.bz2</a>
(tar/bzip2, 1.1 <abbr>MB</abbr>,
<a href="mpfr-2.4.2.tar.bz2.asc" title="PGP signature for mpfr-2.4.2.tar.bz2">signature</a>),</li>
<li><a href="mpfr-2.4.2.tar.gz">mpfr-2.4.2.tar.gz</a>
(tar/gzip, 1.4 <abbr>MB</abbr>,
<a href="mpfr-2.4.2.tar.gz.asc" title="PGP signature for mpfr-2.4.2.tar.gz">signature</a>),</li>
<li><a href="mpfr-2.4.2.zip">mpfr-2.4.2.zip</a>
(zip, 1.7 <abbr>MB</abbr>,
<a href="mpfr-2.4.2.zip.asc" title="PGP signature for mpfr-2.4.2.zip">signature</a>).</li>
</ul>

<p><acronym>MPFR</acronym> is also available via
<a href="../ports.html">third-party packages and ports</a>.</p>

<h2 id="doc">Documentation</h2>

<ul>

<li>The reference manual:
[<a href="mpfr.html" title="Reference manual in HTML format">html</a>]
[<a href="mpfr.dvi.gz" title="Reference manual in DVI format">dvi</a>]
[<a href="mpfr.ps.gz" title="Reference manual in Postscript format">ps</a>]
[<a href="mpfr.pdf" title="Reference manual in PDF format">pdf</a>]</li>

<li>The <a href="../faq.html"><acronym>MPFR</acronym>
<acronym title="Frequently Asked Questions">FAQ</acronym></a>
(common to all <acronym>MPFR</acronym> versions).</li>

</ul>

<h2 id="bugs">Bugs</h2>

<p>The bugs <a href="#fixed">listed below</a> have been fixed (latest
update: 2010-01-11). The patches are distributed under the same license as
this version of <acronym>MPFR</acronym>, that is, the <acronym>GNU</acronym>
Lesser General Public License (<acronym>GNU</acronym> Lesser
<acronym>GPL</acronym>), version 2.1 or later. Note that patches
from the trunk (<em>not</em> listed on this page) are under the
<acronym>GNU</acronym> Lesser <acronym>GPL</acronym> version 3 or
later, thus may be backported <em>only</em> by the authors or the
<acronym title="Free Software Foundation">FSF</acronym> without
a license upgrade.</p>

<p>The following instructions are for Linux and may be similar for
other operating systems. You can apply the patches in several ways:</p>

<ul>

<li>Apply the <a href="allpatches">cumulative patch</a> on the 2.4.2 release
or a partially patched version with the command
<pre>patch -N -Z -p1 &lt; <var>path_to_patches_file</var></pre>
from the source directory. The <samp>-N</samp> option allows the
<samp>patch</samp> command to ignore patches already applied. The
<samp>-Z</samp> option sets the modification time of the patched files
from time stamps given in the patch file, thus avoiding the need of some
development utilities (such as <cite>autoconf</cite>); this may generate
a <q>Not setting time</q> warning for the <samp>PATCHES</samp> file, but
you can safely ignore it. Under Microsoft Windows, in addition to the
above options, you may need the <samp>--binary</samp> option (this depends
whether the end-of-lines have been converted when you downloaded the patch
file). Also note that the <samp>--dry-run</samp> option does not work with
this cumulative patch.</li>

<li>Or apply the individual patches below.</li>

<li>Or checkout the 2.4 branch from the Subversion repository,
<abbr>e.g.</abbr> with the command
<pre>svn co svn://scm.gforge.inria.fr/svn/mpfr/branches/2.4 mpfr-2.4</pre>
In this case, as said on the <a href="../gforge.html">Gforge page</a>, you
should read the <samp>README.dev</samp> file for details on how to build
<acronym>MPFR</acronym>. Also note that the branch may contain additional
minor fixes.</li>

</ul>

<p>With the first two ways, the <samp>PATCHES</samp> file is modified,
so that one can know what patches have been applied, using the new
<samp>mpfr_get_patches</samp> function. Moreover a suffix is added to
the version string, but note that for practical reasons, not all the
files where the version appears are patched; thus one can also track
applied patches with the <code>MPFR_VERSION_STRING</code> macro (header)
and the <code>mpfr_get_version</code> function (library). However, if
some patches are not applied or if patches are applied in a different
order, then the patch command will fail to update some chunks, so that
the suffix is not always reliable for patches.</p>

<p>Note: These patches are in unified diff format and some vendors'
<samp>patch</samp> commands cannot deal with them; in this case, please
use <a href="http://directory.fsf.org/patch.html"><acronym>GNU</acronym>
patch</a> (it <em>may</em> already be installed on your system, e.g. as
<samp>/usr/local/bin/patch</samp> or <samp>gpatch</samp>).</p>

<p id="fixed">Fixed bugs:</p>

<ol>

<li id="p1">If the <code>mpfr_sin_cos</code> function is called on
the minimum positive number or its opposite allowed by the current
<acronym>MPFR</acronym> implementation (in the largest exponent range)
and the rounding mode is toward zero or equivalent, then an underflow
occurs but the underflow flag is not set. This bug in fixed by the
<a href="patch01"><samp>sin_cos_underflow</samp> patch</a> (which also
provides additional tests of <code>mpfr_sin_cos</code> to trigger this
bug).<br />
[Changeset:
<a href="https://gforge.inria.fr/scm/viewvc.php?view=rev&amp;root=mpfr&amp;revision=6629">6629</a>]</li>

<li id="p2">Due to a <a href="http://gcc.gnu.org/gcc-4.4/changes.html">change
in <acronym>GCC</acronym> 4.4 internals</a> for <acronym>MIPS</acronym>, the
<acronym>MPFR</acronym> build fails on <acronym>MIPS</acronym> processors
with <acronym>GCC</acronym> 4.4 and later.
The <a href="patch02"><samp>longlong.h</samp> patch</a> (written
by <a href="http://www.aurel32.net/">Aurélien Jarno</a>) solves
this problem.<br />
[Changeset:
<a href="https://gforge.inria.fr/scm/viewvc.php?view=rev&amp;root=mpfr&amp;revision=6638">6638</a>]</li>

<li id="p3">Due to an internal change in <acronym>GMP</acronym>,
<a href="http://websympa.loria.fr/wwsympa/arc/mpfr/2010-01/msg00008.html"><acronym>MPFR</acronym>
cannot be built with the <acronym>GMP</acronym> 5 internal files</a>
(option <samp>--with-gmp-build</samp>). The
<a href="patch03"><samp>gmp5</samp> patch</a> from Patrick Pélissier
solves this problem.<br />
[Changeset:
<a href="https://gforge.inria.fr/scm/viewvc.php?view=rev&amp;root=mpfr&amp;revision=6651">6651</a>]</li>

</ol>

<p>The internal <code>mpfr_exp_2</code> function, called by
<code>mpfr_exp</code> when the target precision is less than some
threshold, can suffer from a buffer overflow.<br />
[Changeset:
<a href="https://gforge.inria.fr/scm/viewvc.php?view=rev&amp;root=mpfr&amp;revision=6956">6956</a>]</p>

<p id="unfixed">Other bugs: please see the <a href="https://gforge.inria.fr/tracker/?group_id=136">tracker</a> and the <a href="https://gforge.inria.fr/scm/viewvc.php/tags/2.4.2/BUGS?view=markup&amp;root=mpfr&amp;pathrev=6606"><samp>BUGS</samp></a> file.</p>

<p>Other problems, which are not <acronym>MPFR</acronym> bugs:</p>

<ul>

<li>Due to a bug in libtool 2.2.6, used to generate the scripts in the
<acronym>MPFR</acronym> 2.4.2 tarball, useless checks for C++ and Fortran
compilers are done. The only consequence should be that the configure step
can be a bit longer. A freeze or failure because of such checks would be
due to a broken installation of C++ and Fortran compilers. These checks
have now completely been removed in the 2.4 branch (and the trunk).</li>

<li id="stdint">On some platforms, the build of C++ programs using both
<acronym>MPFR</acronym> and <a href="http://www.boost.org/">Boost</a> can
fail with Boost 1.42 and above, because the types <code>intmax_t</code>
and <code>uintmax_t</code> are not defined. This is due to a heuristic
used by <acronym>MPFR</acronym> (in the <samp>mpfr.h</samp> header file)
to guess whether <samp>&lt;stdint.h&gt;</samp> has been included or not.
As this heuristic may fail with some C++ libraries,
<a href="https://gforge.inria.fr/scm/viewvc.php?view=rev&amp;root=mpfr&amp;revision=6699">it
will be disabled for C++ compilers in <acronym>MPFR</acronym> 3</a>. In
the mean time, several workarounds can be used to avoid this problem:
<ul>
<li>Include <samp>mpfr.h</samp> <em>before</em> C++ library headers
(not after).</li>
<li>Define the types <code>intmax_t</code> and <code>uintmax_t</code>
before <samp>mpfr.h</samp> is included. As Boost defines them in the
<samp>std</samp> namespace, this can be done with:
<pre>
using std::intmax_t;
using std::uintmax_t;
</pre>
but make sure that Boost headers (or <samp>&lt;cstdint&gt;</samp> if
your platform has it) are included before.</li>
<li>A global change: modify <samp>mpfr.h</samp> to disable the heuristic
for C++ compilers (<em>not recommended</em> now, as this introduces an
<acronym title="Application Program Interface">API</acronym> change with
such compilers).</li>
</ul>
You can read the
<a href="http://websympa.loria.fr/wwsympa/arc/mpfr/2010-02/msg00010.html">full
discussion on the <acronym>MPFR</acronym> mailing-list</a> or
<a href="http://thread.gmane.org/gmane.comp.lib.mpfr.general/669">on
the Gmane mirror</a>.</li>

</ul>

<h2 id="changes">Changes from version 2.4.1 to version 2.4.2</h2>

<ul>

<li>Security fix in formatted output functions (buffer overflow).</li>

<li>Formatted output functions: 6 is now the default value for
empty precision field with <samp>%Rf</samp>.</li>

<li>Better portability of <samp>configure</samp> script.</li>

<li>Detection of <code>intmax_t</code> and <code>uintmax_t</code> types.</li>

<li>Improved documentation: <code>mpfr_get_z_exp</code>,
<code>mpfr_strtofr</code>, <code>mpfr_get_str</code> and
formatted output functions.</li>

<li>Improved message in case of assertion failure.</li>

<li>Updated <code>tcmp_ld</code> test to really test the
<code>long double</code>.</li>

<li>Some documentation files are installed in <samp>$docdir</samp>.</li>

<li>Removed <code>mpfr_init_cache</code> (unused and undocumented
function).</li>

<li>Fixed the way <samp>$CC</samp> / <samp>$CFLAGS</samp> are got from
<samp>gmp.h</samp> (<code>__GMP_CC</code> / <code>__GMP_CFLAGS</code>).</li>

<li>Bug fixes.</li>

<li>Also note that <acronym>GCC</acronym> 4.4.0 (only this obsolete
version) does not build <acronym>MPFR</acronym> 2.4.2 correctly;
this is detected by <q><samp>make check</samp></q> (failures in
<samp>tget_z</samp> and <samp>tpow_all</samp>).</li>

</ul>

<p><a href="../mpfr-2.4.1/index.html#changes">Changes in <acronym>MPFR</acronym> 2.4.1</a>.</p>

<h2 id="platforms">Platforms Known to Support <acronym>MPFR</acronym></h2>

<p><acronym>MPFR</acronym> 2.4.2 has been successfully
compiled and checked on the following platforms:</p>

<ul>
<li><samp>armv6l-unknown-linux-gnueabi</samp> (OMAP 2420 ARMv6-compatible processor rev 2, <acronym>gcc</acronym> 3.4.4),</li>
<li><samp>hppa2.0w-hp-hpux11.11</samp> (HP C/HP-UX Version B.11.11.16),</li>
<li><samp>i386-pc-solaris2.8</samp> (Sun C 5.8 Patch 121016-08 2009/04/20),</li>
<li><samp>i386-pc-solaris2.10</samp> (Sun C 5.8 Patch 121016-08 2009/04/20 and Sun C 5.9 SunOS_i386 Patch 124868-10 2009/04/30),</li>
<li><samp>i586-suse-linux-gnu</samp> (<acronym>gcc</acronym> 4.4.2),</li>
<li><samp>i686-pc-linux-gnu</samp> (<acronym>gcc</acronym> 3.2.3 and 4.1.2, and <acronym>icc</acronym> 11.0),</li>
<li><samp>ia64-suse-linux-gnu</samp> (<acronym>gcc</acronym> 4.4.2),</li>
<li><samp>ia64-unknown-linux-gnu</samp> (Itanium, <acronym>gcc</acronym> 4.1.2 and <acronym>icc</acronym> 10.1 and 11.0),</li>
<li><samp>powerpc-apple-darwin8.11.0</samp> (PowerPC G5, <acronym>gcc</acronym> 4.0.1, 32 and 64 bits),</li>
<li><samp>powerpc-unknown-linux-gnu</samp> (PowerPC G4, <acronym>gcc</acronym> 4.3.4),</li>
<li><samp>ppc-suse-linux-gnu</samp> (<acronym>gcc</acronym> 4.4.2),</li>
<li><samp>ppc64-suse-linux-gnu</samp> (<acronym>gcc</acronym> 4.4.2),</li>
<li><samp>s390-suse-linux-gnu</samp> (<acronym>gcc</acronym> 4.4.2),</li>
<li><samp>s390x-suse-linux-gnu</samp> (<acronym>gcc</acronym> 4.4.2),</li>
<li><samp>x86_64-suse-linux-gnu</samp> (<acronym>gcc</acronym> 4.4.2),</li>
<li><samp>x86_64-unknown-linux-gnu</samp> (<acronym>gcc</acronym> 4.1.2, <acronym>gcc</acronym> and g++ 4.3.4, <acronym>gcc</acronym> 4.5 snapshot, <acronym>opencc</acronym> 4.1, <acronym>llvm-gcc</acronym> 4.2.1, and <acronym>icc</acronym> 11.0).</li>
</ul>

<p><a href="../index.html">Back to the <acronym>MPFR</acronym> page.</a></p>

<hr />

<div class="footer"><a href="http://validator.w3.org/check/referer"><img
  src="http://www.w3.org/Icons/valid-xhtml10"
  alt="Valid XHTML 1.0!" height="31" width="88" /></a></div>

</body>

</html>
