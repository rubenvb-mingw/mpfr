<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Starting With the MPFR Library</title>
<link rel="shortcut icon" href="favicon.ico" />
<link rel="stylesheet" type="text/css" href="styles/screen.css" media="screen,tv,projection" />
<link rel="stylesheet" type="text/css" href="styles/print.css" media="print" />
<link rel="top" title="The MPFR Library" href="index.html" />
<link rel="up" title="The MPFR Library" href="index.html" />
</head>

<body class="block-code">

<div class="logo"><a href="index.html"><img src="mpfr100.png" height="40" width="100" alt="[MPFR]" /></a></div>

<h1>Starting With the <cite><acronym>MPFR</acronym></cite> Library</h1>

<p>The following program computes a lower bound on 1+1/1!+1/2!+...+1/100!
using 200-bit precision: <code>mpfr_t s, t, u;</code> declares three
floating-point variables <var>s</var>, <var>t</var>, <var>u</var>;
<code>mpfr_init2 (t, 200);</code> initializes the variable <var>t</var> with
200-bit precision; then <code>mpfr_set_d (t, 1.0, GMP_RNDD);</code> sets the
value of <var>t</var> to the double-precision number 1.0 rounded towards
minus infinity (here no rounding is done since 1 can be represented exactly
on 200 bits); the statement <code>mpfr_mul_ui (t, t, i, GMP_RNDU);</code>
multiplies <var>t</var> in place by the unsigned integer <var>i</var>,
where the result is rounded towards plus infinity;
<code>mpfr_div (u, u, t, GMP_RNDD);</code> divides <var>u</var> by
<var>t</var>, rounds the result towards minus infinity and stores it
into <var>u</var>; then the statement
<code>mpfr_out_str (stdout, 10, 0, s, GMP_RNDD);</code> prints the value of
<var>s</var> in base 10, rounded towards minus infinity, where the third
argument 0 means that the number of printed digits is automatically chosen
from the precision of <var>s</var>; finally the <code>mpfr_clear</code>
calls free the space used by the <cite><acronym>MPFR</acronym></cite>
variables.</p>

<pre>#include &lt;stdio.h&gt;

#include &lt;gmp.h&gt;
#include &lt;mpfr.h&gt;

int main (void)
{
  unsigned int i;
  mpfr_t s, t, u;

  mpfr_init2 (t, 200);
  mpfr_set_d (t, 1.0, GMP_RNDD);
  mpfr_init2 (s, 200);
  mpfr_set_d (s, 1.0, GMP_RNDD);
  mpfr_init2 (u, 200);
  for (i = 1; i &lt;= 100; i++)
    {
      mpfr_mul_ui (t, t, i, GMP_RNDU);
      mpfr_set_d (u, 1.0, GMP_RNDD);
      mpfr_div (u, u, t, GMP_RNDD);
      mpfr_add (s, s, u, GMP_RNDD);
    }
  printf ("Sum is ");
  mpfr_out_str (stdout, 10, 0, s, GMP_RNDD);
  putchar ('\n');
  mpfr_clear (s);
  mpfr_clear (t);
  mpfr_clear (u);
  return 0;
}</pre>

<p>The result of this program is:</p>
<pre>$ ./sample
Sum is 2.718281828459045235360287471352662497757247093699959574966913</pre>

<p><a href="index.html">Back to the <cite><acronym>MPFR</acronym></cite>
page.</a></p>

<hr />

<div class="footer"><a href="http://validator.w3.org/check/referer"><img
  src="http://www.w3.org/Icons/valid-xhtml10"
  alt="Valid XHTML 1.0!" height="31" width="88" /></a></div>

</body>

</html>
