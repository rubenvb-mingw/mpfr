<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>GNU MPFR version 3.1.3</title>
<link rel="shortcut icon" href="../favicon.ico" />
<link rel="stylesheet" type="text/css" href="../styles/screen.css" media="screen,tv,projection" />
<link rel="stylesheet" type="text/css" href="../styles/print.css" media="print" />
<link rel="top" title="The GNU MPFR Library" href="../index.html" />
<link rel="up" title="The GNU MPFR Library" href="../index.html" />
</head>

<body>

<div class="logo"><a href="../index.html"><img src="../mpfr100.png" height="40" width="100" alt="[MPFR]" /></a></div>

<h1><acronym>GNU</acronym> <acronym>MPFR</acronym> version 3.1.3 (released on 19 June 2015)</h1>

<div>[<a href="#download">download</a>]
[<a href="#doc">documentation</a>]
[<a href="#bugs">bugs</a>]
[<a href="#changes">changes</a>]
[<a href="#platforms">platforms</a>]
[<a href="../mpfr-3.1.2/timings.html" title="Comparison of other software to MPFR 3.1.2">timings of 3.1.2</a>]</div>

<p>The <cite lang="fr" xml:lang="fr">canard à l'orange</cite> release, patch level 3.</p>

<p><acronym>MPFR</acronym> 3.1.3 requires <acronym>GMP</acronym> 4.1.0
or higher (<acronym>GMP</acronym> 4.2.3 or higher is recommended).</p>

<p><strong>Warning! Due to the fact that
<acronym title="Thread Local Storage">TLS</acronym> support is now detected
automatically, the <acronym>MPFR</acronym> build can be incorrect on some
platforms</strong> (compiler or system bug). Indeed,
<a href="http://www.loria.fr/~zimmerma/software/compilerbugs.html">the
<acronym>TLS</acronym> implementation of some compilers/platforms is buggy</a>,
and <acronym>MPFR</acronym> cannot detect every problem at configure time.
Please run <q><samp>make check</samp></q> to see if your build is affected.
If you get failures, you should try the <samp>--disable-thread-safe</samp>
configure option to disable <acronym>TLS</acronym> and see if this solves
these failures. But you should not use an <acronym>MPFR</acronym> library
with <acronym>TLS</acronym> disabled in a multithreaded program (unless
you know what you are doing).</p>

<h2 id="download">Download</h2>

<p>The <acronym>MPFR</acronym> 3.1.3 source can be downloaded in the
following archive formats:</p>
<ul>
<li><a href="mpfr-3.1.3.tar.xz">mpfr-3.1.3.tar.xz</a>
(tar/xz, 1.1 <abbr>MB</abbr>,
<a href="mpfr-3.1.3.tar.xz.asc" title="PGP signature for mpfr-3.1.3.tar.xz">signature</a>),</li>
<li><a href="mpfr-3.1.3.tar.bz2">mpfr-3.1.3.tar.bz2</a>
(tar/bzip2, 1.3 <abbr>MB</abbr>,
<a href="mpfr-3.1.3.tar.bz2.asc" title="PGP signature for mpfr-3.1.3.tar.bz2">signature</a>),</li>
<li><a href="mpfr-3.1.3.tar.gz">mpfr-3.1.3.tar.gz</a>
(tar/gzip, 1.7 <abbr>MB</abbr>,
<a href="mpfr-3.1.3.tar.gz.asc" title="PGP signature for mpfr-3.1.3.tar.gz">signature</a>),</li>
<li><a href="mpfr-3.1.3.zip">mpfr-3.1.3.zip</a>
(zip, 2.0 <abbr>MB</abbr>,
<a href="mpfr-3.1.3.zip.asc" title="PGP signature for mpfr-3.1.3.zip">signature</a>).</li>
</ul>

<p>Each tarball is signed by Vincent Lefèvre. This can be verified using the
<acronym title="Digital Signature Algorithm">DSA</acronym> key <abbr>ID</abbr>
<samp>98C3739D</samp>; this key can be retrieved with:</p>
<pre>gpg --recv-keys 98C3739D</pre>
<p>or by downloading it from
<a href="https://www.vinc17.net/pgp.html">https://www.vinc17.net/pgp.html</a>.
The key fingerprint is:</p>
<pre>07F3 DBBE CC1A 3960 5078  094D 980C 1976 98C3 739D</pre>
<p>The signatures can be verified with:</p>
<pre>gpg --verify <em>file.asc</em></pre>
<p>You should check that the key fingerprint matches.</p>

<p><acronym>MPFR</acronym> is also available via
<a href="../ports.html">third-party packages and ports</a>.</p>

<h2 id="doc">Documentation</h2>

<ul>

<li>The reference manual:
[<a href="mpfr.html" title="Reference manual in HTML format">html</a>]
[<a href="mpfr.dvi.gz" title="Reference manual in DVI format">dvi</a>]
[<a href="mpfr.ps.gz" title="Reference manual in Postscript format">ps</a>]
[<a href="mpfr.pdf" title="Reference manual in PDF format">pdf</a>]</li>

<li>The <a href="../faq.html"><acronym>MPFR</acronym>
<acronym title="Frequently Asked Questions">FAQ</acronym></a>
(common to all <acronym>MPFR</acronym> versions).</li>

</ul>

<h2 id="bugs">Bugs</h2>

<p>The bugs <a href="#fixed">listed below</a> have been fixed (latest
update: 2016-02-15). The patches are distributed under the same license as
this version of <acronym>MPFR</acronym>, that is, the <acronym>GNU</acronym>
Lesser General Public License (<acronym>GNU</acronym> Lesser
<acronym>GPL</acronym>), version 3 or later.</p>

<p>The following instructions are for Linux and may be similar for
other operating systems. You can apply the patches in several ways:</p>

<ul>

<li>Apply the <a href="allpatches">cumulative patch</a>
(<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr/misc/www/mpfr-3.1.3/allpatches?view=co">version on Gforge via https</a>)
on the 3.1.3 release or a partially patched version with the command
<pre>patch -N -Z -p1 &lt; <var>path_to_patches_file</var></pre>
from the source directory. The <samp>-N</samp> option allows the
<samp>patch</samp> command to ignore patches already applied. The
<samp>-Z</samp> option sets the modification time of the patched files
from time stamps given in the patch file, thus avoiding the need of some
development utilities (such as <cite>autoconf</cite>); this may generate
a <q>Not setting time</q> warning for the <samp>PATCHES</samp> file, but
you can safely ignore it. Under Microsoft Windows, in addition to the
above options, you may need the <samp>--binary</samp> option (this depends
whether the end-of-lines have been converted when you downloaded the patch
file). Also note that the <samp>--dry-run</samp> option does not work if
the cumulative patch has some file listed several times.</li>

<li>Or apply the individual patches below.</li>

<li>Or checkout the 3.1 branch from the Subversion repository,
<abbr>e.g.</abbr> with the command
<pre>svn co svn://scm.gforge.inria.fr/svn/mpfr/branches/3.1 mpfr-3.1</pre>
(Warning! No authentication is done.)
In this case, as said on the <a href="../gforge.html">Gforge page</a>,
you should read the
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr/tags/3.1.3/doc/README.dev?view=markup"><samp>README.dev</samp></a>
file for details on how to build <acronym>MPFR</acronym>.
Also note that the branch may contain additional minor fixes.</li>

</ul>

<p>With the first two ways, the <samp>PATCHES</samp> file is modified,
so that one can know what patches have been applied, using the new
<samp>mpfr_get_patches</samp> function. Moreover a suffix is added to
the version string, but note that for practical reasons, not all the
files where the version appears are patched; thus one can also track
applied patches with the <code>MPFR_VERSION_STRING</code> macro (header)
and the <code>mpfr_get_version</code> function (library). However, if
some patches are not applied or if patches are applied in a different
order, then the patch command will fail to update some chunks, so that
the suffix is not always reliable for patches.</p>

<p>Note: These patches are in unified diff format and some vendors'
<samp>patch</samp> commands cannot deal with them; in this case, please
use <a href="http://directory.fsf.org/project/patch/"><acronym>GNU</acronym>
patch</a> (it <em>may</em> already be installed on your system, e.g. as
<samp>/usr/local/bin/patch</samp> or <samp>gpatch</samp>).</p>

<p id="fixed">Fixed bugs, with patches:</p>

<ol>

<li id="p1">The <code>mpfr_lngamma</code> function gives NaN instead of +Inf
on &#8722;0, on negative integers and on &#8722;Inf. This is fixed by the
<a href="patch01"><samp>lngamma-and-doc</samp> patch</a>, which also fixes
and improves the tests and improves the <acronym>MPFR</acronym> manual
concerning the special values.<br />
Corresponding changeset in the 3.1 branch:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=9605&amp;view=revision">9605</a>.</li>

<li id="p2">The <code>mpfr_mul_2si</code>, <code>mpfr_div_2ui</code> and
<code>mpfr_div_2si</code> functions do not handle a potential overflow
when the integer argument is 0; such an overflow can occur only when the
output has less precision than the input, and this may yield a crash or
a number with an out-of-range exponent. This is fixed by the
<a href="patch02"><samp>muldiv-2exp-overflow</samp> patch</a>,
which also provides testcases.<br />
Corresponding changeset in the 3.1 branch:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=9608&amp;view=revision">9608</a>.</li>

<li id="p3">The <code>mpfr_mul_2si</code>, <code>mpfr_div_2ui</code> and
<code>mpfr_div_2si</code> functions in rounding to nearest can round in
the wrong direction when the exact result is &#8722;2<sup>emin&#8722;2</sup>,
<abbr>i.e.</abbr> the middle of 0 and the minimum negative number in
absolute value. This is fixed by the
<a href="patch03"><samp>muldiv-2exp-underflow</samp> patch</a>,
which also provides testcases.<br />
Corresponding changeset in the 3.1 branch:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=9620&amp;view=revision">9620</a>.</li>

<li id="p4">The <code>mpfr_frexp</code> function does not handle
internal overflow and it can yield an assertion failure when the
current exponent range does not contain 0. This is fixed by the
<a href="patch04"><samp>frexp</samp> patch</a>,
which also provides testcases.<br />
Corresponding changeset in the 3.1 branch:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=9621&amp;view=revision">9621</a>.</li>

<li id="p5">With some <samp>mparam.h</samp> files, the <code>mpfr_div</code>
function can return an incorrect result. This is fixed by the
<a href="patch05"><samp>divhigh-basecase</samp> patch</a>, which also
provides a testcase. Note that this bug is new in <acronym>MPFR</acronym> 3.1
and cannot be triggered with the <samp>mparam.h</samp> files
distributed in the tarball. Thus most users should not be affected.
However this bug may be visible after a <q><samp>make tune</samp></q>
(which generates a new <samp>mparam.h</samp> file).
<a href="https://sympa.inria.fr/sympa/arc/mpfr/2015-10/msg00023.html">More
details in the discussion in the <acronym>MPFR</acronym> list</a>.<br />
Corresponding changeset in the 3.1 branch:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=9711&amp;view=revision">9711</a>.</li>

<li id="p6">The Bessel functions (<code>mpfr_j0</code>, <code>mpfr_j1</code>,
<code>mpfr_jn</code>, <code>mpfr_y0</code>, <code>mpfr_y1</code>,
<code>mpfr_yn</code>) can return an incorrect result. This is fixed by the
<a href="patch06"><samp>jn</samp> patch</a>, which also provides a testcase.
<a href="https://sympa.inria.fr/sympa/arc/mpfr/2016-01/msg00027.html">Bug
report by Fredrik Johansson</a>.<br />
Corresponding changeset in the 3.1 branch:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=9845&amp;view=revision">9845</a>.</li>

<li id="p7">The Riemann Zeta function <code>mpfr_zeta</code> can return an
incorrect result when the argument is near an even negative integer. This
is fixed by the <a href="patch07"><samp>zeta</samp> patch</a>, which also
provides a testcase.
<a href="https://sympa.inria.fr/sympa/arc/mpfr/2016-01/msg00028.html">Bug
report by Fredrik Johansson</a>.<br />
Corresponding changeset in the 3.1 branch:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=9855&amp;view=revision">9855</a>.</li>

<li id="p8">The square root function <code>mpfr_sqrt</code> can return invalid
data under very particular conditions: when the precision of the result is
a multiple of the number of bits per word (<code>GMP_NUMB_BITS</code>), the
rounding mode is to nearest (<code>MPFR_RNDN</code>), and internally, the
result has to be rounded up to a power of 2. This can yield assertion
failures (or other unknown behavior), thus make applications crash. This
is fixed by the <a href="patch08"><samp>sqrt</samp> patch</a>, which also
provides a testcase.
<a href="https://sympa.inria.fr/sympa/arc/mpfr/2016-01/msg00043.html">Bug
report by Fredrik Johansson</a>.<br />
Corresponding changesets in the 3.1 branch:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=9860&amp;view=revision">9860</a>,
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=9862&amp;view=revision">9862</a>.</li>

<li id="p9">The <em>si</em> functions (<code>mpfr_add_si</code>,
<code>mpfr_sub_si</code>, <code>mpfr_si_sub</code>, <code>mpfr_mul_si</code>,
<code>mpfr_div_si</code>, <code>mpfr_si_div</code>) have undefined behavior
when the integer is the minimum one: <code>LONG_MIN</code>. However,
on most processors (if not all), this bug has no visible effect when
<acronym>MPFR</acronym> is compiled in the usual way. It is visible
when using an <q>undefined behavior sanitizer</q>. This is fixed by
the <a href="patch09"><samp>si-ops</samp> patch</a>.<br />
Corresponding changeset in the 3.1 branch:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=10023&amp;view=revision">10023</a>.
Changeset
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=10002&amp;view=revision">10002</a>
improves the generic tests of functions with an integer argument, but
is not included in this patch since it is more general.</li>

<li id="p10">The <code>mpfr_can_round_raw</code> internal rounding-test
function can return true instead of false in case of a change of binade
(more specifically, exponent decrease) on the approximation interval.
This bug affects the <code>mpfr_can_round</code> public function. Some
<acronym>MPFR</acronym> math functions might also be affected, but if
they are, errors should be very rare. Consequences can be inaccurate
results. This is fixed by the <a href="patch10"><samp>can_round</samp>
patch</a>, which also provides testcases and cleans up related code.
<a href="https://sympa.inria.fr/sympa/arc/mpfr/2016-01/msg00066.html">Bug
report and discussion</a>.<br />
Corresponding changeset in the 3.1 branch:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=10029&amp;view=revision">10029</a>.</li>

<li id="p11">The <code>mpfr_fits_*</code> functions
(<code>mpfr_fits_ulong_p</code>, <code>mpfr_fits_slong_p</code>,
<code>mpfr_fits_uint_p</code>, <abbr>etc.</abbr>) can set some flags,
while the flags should not be modified. These functions can also trigger
assertion failures for non-integer numbers just above the positive limit
of the type when additional assertions are checked (<acronym>MPFR</acronym>
configured with <samp>--enable-assert</samp>). This is fixed by the
<a href="patch11"><samp>fits</samp> patch</a>, which also provides
testcases.<br />
Corresponding changeset in the 3.1 branch:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=10035&amp;view=revision">10035</a>.</li>

<li id="p12">The <code>mpfr_root</code> function, which computes the
<var>k</var>th root of a floating-point number has major issues with large
values of <var>k</var>: <acronym>MPFR</acronym> can take much memory, and
when <var>k</var> is very large, <acronym>MPFR</acronym> can crash or the
function can return an incorrect result due to internal integer overflow.
This is fixed by the <a href="patch12"><samp>root</samp> patch</a>, which
also provides testcases. This has been done by changing the algorithm for
<var>k</var> &gt; 100.
<a href="https://sympa.inria.fr/sympa/arc/mpfr/2016-02/msg00007.html">Bug
report</a>.<br />
Corresponding changeset in the 3.1 branch:
<a href="https://gforge.inria.fr/scm/viewvc.php/mpfr?revision=10040&amp;view=revision">10040</a>.</li>

</ol>

<!-- For BUGS, it's better to point to HEAD, as changes will be noted above. -->
<p>Other bugs: please see the <a href="https://gforge.inria.fr/tracker/?group_id=136">tracker</a> and the <a href="https://gforge.inria.fr/scm/viewvc.php/mpfr/trunk/BUGS?view=markup"><samp>BUGS</samp></a> file.</p>

<h2 id="changes">Changes from version 3.1.2 to version 3.1.3</h2>

<ul>

<li>Better support for Automake 1.13+ (now used to generate the tarball).</li>

<li>Improved <acronym>MPFR</acronym> manual.</li>

<li>Bug fixes (<a href="../mpfr-3.1.2/#fixed">detailed list on the <cite><acronym>MPFR</acronym></cite> 3.1.2 page</a> and <samp>ChangeLog</samp> file).</li>

</ul>

<h2 id="platforms">Platforms Known to Support <cite><acronym>MPFR</acronym></cite></h2>

<p><cite><acronym>MPFR</acronym></cite> 3.1.3 has been successfully
compiled and checked on the following platforms:</p>

<ul>
<li><samp>amd64-unknown-openbsd5.8</samp> (OpenBSD 5.8 Beta, <acronym>gcc</acronym> 4.2.1),</li>
<li><samp>armv5tejl-unknown-linux-gnueabi</samp> (ARM926EJ-S rev 5, <acronym>gcc</acronym> 4.4.5, under <cite>qemu</cite>),</li>
<li><samp>i386-pc-solaris2.10</samp> (Sun C 5.9 SunOS_i386 Patch 124868-10 2009/04/30),</li>
<li><samp>i386-pc-solaris2.11</samp> (Oracle Solaris 11.2, <acronym>gcc</acronym> 4.8.2),</li>
<li><samp>i686-w64-mingw32</samp> (Windows 2012 R2, <acronym>gcc</acronym> 4.9.2),</li>
<li><samp>powerpc64-unknown-linux-gnu</samp> (POWER7, <acronym>gcc</acronym> 4.7.2),</li>
<li><samp>x86_64-apple-darwin14.3.0</samp> (<acronym>gcc</acronym> from Apple's <cite>Command Line Tools</cite>),</li>
<li><samp>x86_64-pc-solaris2.11</samp> (Oracle Solaris 11.2, <acronym>gcc</acronym> 4.8.2),</li>
<li><samp>x86_64-unknown-dragonfly4.2</samp> (DragonFly BSD 4.2 RC, <acronym>gcc</acronym> 5.1.1),</li>
<li><samp>x86_64-unknown-freebsd10.1</samp> (FreeBSD 10.1-RELEASE-p13, clang 3.4.1),</li>
<li><samp>x86_64-unknown-linux-gnu</samp> (<acronym>gcc</acronym> 4.4.7, 4.7.4, 4.8.3, 4.9.2, 5.1.1 and 6.0.0 snapshot, g++ 4.9.2, <acronym>llvm-gcc</acronym> 4.8.4, clang 3.4.2, 3.5.2 and 3.6.1, <acronym>icc</acronym> 15.0.0, and <acronym>tcc</acronym> 0.9.26),</li>
<li><samp>x86_64-unknown-netbsd5.1</samp> (NetBSD 5.1, <acronym>gcc</acronym> 4.1.3),</li>
<li><samp>x86_64-unknown-netbsd6.1</samp> (NetBSD 6.1.5_PATCH, <acronym>gcc</acronym> 4.5.3),</li>
<li><samp>x86_64-unknown-netbsd7.0</samp> (NetBSD 7.0_RC1, <acronym>gcc</acronym> 4.8.4),</li>
<li><samp>x86_64-w64-mingw32</samp> (Windows 2012 R2, <acronym>gcc</acronym> 4.9.2).</li>
</ul>

<p><a href="../index.html">Back to the <cite><acronym>MPFR</acronym></cite>
page.</a></p>

<hr />

<div class="footer"><a href="http://validator.w3.org/check/referer"><img
  src="http://www.w3.org/Icons/valid-xhtml10"
  alt="Valid XHTML 1.0!" height="31" width="88" /></a></div>

</body>

</html>
